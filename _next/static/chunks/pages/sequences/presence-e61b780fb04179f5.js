(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4665],{4804:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sequences/presence",function(){return r(5649)}])},5649:function(e,t,r){"use strict";r.r(t),r.d(t,{__toc:function(){return c}});var n=r(5893),a=r(2673),s=r(5417),i=r(3209);r(4759);var o=r(2643),l=r(8757);let c=[];function u(e){return(0,n.jsx)(l.G,{chart:"sequenceDiagram\n    participant ClientApp as Client Application\n    participant ClientService as Client PresenceService\n    participant ClientHandler as Client PresenceHandler\n    participant ServerHandler as Server PresenceHandler\n    participant ServerStorage as Server Storage\n    participant ServerSession as Server SessionManager\n\n    Note over ClientApp, ServerSession: Heartbeat\n    ClientApp->>ServerHandler: HEARTBEAT_REQUEST\n    ServerHandler-->>ClientApp: HEARTBEAT_RESPONSE\n    ServerHandler->>ServerSession: Update last_heartbeat_time\n\n    Note over ClientApp, ServerSession: User Status Update Notification (e.g., on login/logout of another user)\n    ServerHandler->>ClientHandler: USER_STATUS_UPDATE_NOTIFICATION\n    ClientHandler->>ClientApp: Update UI (user status changed)\n\n    Note over ClientApp, ServerSession: Query User Status (Specific Users)\n    ClientApp->>ClientService: query_specific_user_status(user_id)\n    ClientService->>ServerHandler: QUERY_USER_STATUS_REQUEST (target_user_ids=[user_id])\n    ServerHandler->>ServerStorage: get_user_by_user_id(user_id)\n    ServerStorage-->>ServerHandler: User data or None\n    ServerHandler->>ServerSession: get_session_by_user_id(user_id)\n    ServerSession-->>ServerHandler: Session info or None\n    ServerHandler-->>ClientService: QUERY_USER_STATUS_RESPONSE (results)\n    ClientService->>ClientHandler: handle_query_user_status_response(message)\n    ClientHandler->>ClientApp: Update UI (user statuses)\n\n    Note over ClientApp, ServerSession: Query User Status (All Users)\n    ClientApp->>ClientService: query_all_user_status()\n    ClientService->>ServerHandler: QUERY_USER_STATUS_REQUEST (target_user_ids=[])\n    ServerHandler->>ServerStorage: get_all_users()\n    ServerStorage-->>ServerHandler: List of all users\n    ServerHandler->>ServerSession: get_all_sessions()\n    ServerSession-->>ServerHandler: List of all sessions\n    ServerHandler-->>ClientService: QUERY_USER_STATUS_RESPONSE (results for all users)\n    ClientService->>ClientHandler: handle_query_user_status_response(message)\n    ClientHandler->>ClientApp: Update UI (all user statuses)\n"})}let d={MDXContent:function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},{wrapper:t}=Object.assign({},(0,o.a)(),e.components);return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(u,{...e})}):u(e)},pageOpts:{filePath:"pages/sequences/presence.md",route:"/sequences/presence",timestamp:1749055448e3,pageMap:[{kind:"Meta",data:{index:{title:"Introduction",type:"page",display:"hidden"},demo:{title:"Demo & Introduction",type:"page"},protocol:{title:"Protocol",type:"page"},sequence:{title:"Sequence Flow",type:"page"},database:{title:"Database Design",type:"page"},uml:{title:"UML Structure",type:"page"},"stress-test":{title:"Stress Testing",type:"page",display:"hidden"}}},{kind:"MdxPage",name:"database",route:"/database"},{kind:"MdxPage",name:"demo",route:"/demo"},{kind:"MdxPage",name:"index",route:"/"},{kind:"Folder",name:"protocol",route:"/protocol",children:[{kind:"Meta",data:{index:{title:"Protocol Overview",type:"page"},authentication:{title:"Authentication",type:"page"},private_chat:{title:"Private Chat",type:"page"},group_chat:{title:"Group Chat",type:"page"},presence:"Presence"}},{kind:"MdxPage",name:"authentication",route:"/protocol/authentication"},{kind:"MdxPage",name:"group_chat",route:"/protocol/group_chat"},{kind:"MdxPage",name:"index",route:"/protocol"},{kind:"MdxPage",name:"presence",route:"/protocol/presence"},{kind:"MdxPage",name:"private_chat",route:"/protocol/private_chat"}]},{kind:"MdxPage",name:"sequence",route:"/sequence"},{kind:"Folder",name:"sequences",route:"/sequences",children:[{kind:"MdxPage",name:"authentication",route:"/sequences/authentication"},{kind:"MdxPage",name:"group_chat",route:"/sequences/group_chat"},{kind:"MdxPage",name:"presence",route:"/sequences/presence"},{kind:"MdxPage",name:"private_chat",route:"/sequences/private_chat"},{kind:"Meta",data:{authentication:"Authentication",group_chat:"Group Chat",presence:"Presence",private_chat:"Private Chat"}}]},{kind:"MdxPage",name:"stress-test",route:"/stress-test"},{kind:"MdxPage",name:"uml",route:"/uml"}],flexsearch:{codeblocks:!0},readingTime:{text:"0 min read",minutes:0,time:0,words:0},title:"Presence",headings:c},pageNextRoute:"/sequences/presence",nextraLayout:s.ZP,themeConfig:i.Z};t.default=(0,a.j)(d)},3209:function(e,t,r){"use strict";var n=r(5893),a=r(7656),s=r(1163);let i={logo:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(a.Z,{size:24,className:"mr-2"}),(0,n.jsx)("span",{className:"font-bold text-xl",children:"Whisper Chat"})]}),project:{link:"https://github.com/ukeSJTU/whisper"},docsRepositoryBase:"https://github.com/ukeSJTU/whisper-docs",footer:{text:(0,n.jsxs)("span",{children:["\xa9 ",new Date().getFullYear()," Whisper Chat. All rights reserved."]})},useNextSeoProps(){let{asPath:e}=(0,s.useRouter)();return{titleTemplate:"/"!==e?"%s – Whisper Chat":"Whisper Chat - Secure Real-Time Communication",description:"Whisper is a modern, secure web-based chat application for real-time communication."}},head:(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1.0"}),(0,n.jsx)("meta",{name:"description",content:"Whisper is a modern, secure web-based chat application for real-time communication."}),(0,n.jsx)("meta",{name:"og:title",content:"Whisper Chat"}),(0,n.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),banner:{key:"whisper-release",text:(0,n.jsxs)("span",{children:["\uD83C\uDF89 Try Whisper Chat online →"," ",(0,n.jsx)("a",{href:"https://whisper.ukehome.top",children:"whisper"})]})},primaryHue:{dark:260,light:180},navigation:{prev:!0,next:!0},darkMode:!0,nextThemes:{defaultTheme:"system"}};t.Z=i},5789:function(){},8757:function(e,t,r){"use strict";r.d(t,{G:function(){return i}});var n=r(5893),a=r(7294),s=r(7541);function i({chart:e}){let t=(0,a.useId)(),[r,i]=(0,a.useState)("");return(0,a.useEffect)(()=>{let r=document.documentElement,n=new MutationObserver(a);return n.observe(r,{attributes:!0}),a(),()=>{n.disconnect()};async function a(){let n=r.classList.contains("dark")||r.attributes.getNamedItem("data-theme")?.value==="dark";try{s.N.initialize({startOnLoad:!1,securityLevel:"loose",fontFamily:"inherit",themeCSS:"margin: 1.5rem auto 0;",theme:n?"dark":"default"});let{svg:r}=await s.N.render(t.replaceAll(":",""),e);i(r)}catch(e){console.error("Error while rendering mermaid",e)}}},[e]),(0,n.jsx)("div",{dangerouslySetInnerHTML:{__html:r}})}}},function(e){e.O(0,[7163,2114,3542,2888,9774,179],function(){return e(e.s=4804)}),_N_E=e.O()}]);